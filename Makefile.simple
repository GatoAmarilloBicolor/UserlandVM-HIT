# Simple Makefile for UserlandVM - Non-Headless Compilation
# This builds the main executable without headless mode

CXX = g++
CXXFLAGS = -std=c++17 -O3 -Wall -Wextra -fPIC
LDFLAGS = -lstdc++ -lm -lpthread

TARGET = userlandvm_noheadless

# Only compile Main.cpp - no dependencies on broken headers
SOURCES = Main.cpp
OBJECTS = $(SOURCES:.cpp=.o)

all: $(TARGET)

$(TARGET): $(OBJECTS)
	@echo "ðŸ”— Linking $@..."
	$(CXX) $(CXXFLAGS) -o $@ $(OBJECTS) $(LDFLAGS)
	@ls -lh $@
	@echo "âœ… Build successful: $@"

%.o: %.cpp
	@echo "ðŸ”¨ Compiling $<..."
	$(CXX) $(CXXFLAGS) -c $< -o $@

clean:
	@echo "ðŸ§¹ Cleaning..."
	rm -f $(OBJECTS) $(TARGET)
	@echo "âœ… Clean complete"

install: $(TARGET)
	@echo "ðŸ“¦ Installing to system..."
	sudo cp $(TARGET) /usr/local/bin/userlandvm-noheadless
	@echo "âœ… Installed to /usr/local/bin/userlandvm-noheadless"

help:
	@echo "UserlandVM Simple Build System"
	@echo "=============================="
	@echo "Targets:"
	@echo "  make         - Build userlandvm_noheadless"
	@echo "  make clean   - Remove build artifacts"
	@echo "  make install - Install to /usr/local/bin"
	@echo "  make help    - Show this help"

.PHONY: all clean install help
